"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = _default;

var _path = require("path");

var _fs = require("fs");

function _default(api) {
  const paths = api.service.paths;
  const winPath = api.utils.winPath;
  const globalFiles = [(0, _path.join)(paths.absSrcPath, 'global.tsx'), (0, _path.join)(paths.absSrcPath, 'global.ts'), (0, _path.join)(paths.absSrcPath, 'global.jsx'), (0, _path.join)(paths.absSrcPath, 'global.js')];

  function getGlobalJS() {
    for (var _i = 0; _i < globalFiles.length; _i++) {
      const file = globalFiles[_i];

      if ((0, _fs.existsSync)(file)) {
        return file;
      }
    }
  }

  api.register('modifyEntryFile', ({
    memo
  }) => {
    const globalJS = getGlobalJS();

    if (globalJS) {
      memo = `import '${winPath(globalJS)}';\r\n${memo}`;
    }

    return memo;
  });
  api.register('modifyPageWatchers', ({
    memo
  }) => {
    return [...memo, ...globalFiles];
  });
}