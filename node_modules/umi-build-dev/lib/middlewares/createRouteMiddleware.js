"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createRouteMiddleware;
exports.setConfig = setConfig;

var _HtmlGenerator = _interopRequireDefault(require("../html/HtmlGenerator"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

let config = null;

function createRouteMiddleware(service) {
  config = service.config;
  return (req, res) => {
    const path = req.path;
    service.applyPlugins('onRouteRequest', {
      args: {
        req
      }
    });
    const htmlGenerator = new _HtmlGenerator.default(service);
    const content = htmlGenerator.getContent(config.exportStatic ? path : undefined);
    res.setHeader('Content-Type', 'text/html');
    res.send(content);
  };
}

function setConfig(_config) {
  config = _config;
}